# Fix NER Production Run


## Content


and to write to parquet files instead of direct to duckdb, struggling







Before Adding Mulitple Source Tagging





~~~{=html}
<pre class="notion-ascii-diagram"><code>======================================================================
<strong>1. PARQUET AUDIT REPORT (BERN2 ONLY)</strong>
======================================================================

<strong>TABLE STATISTICS:</strong>
----------------------------------------------------------------------
<strong>Table                  Parquet Files         Rows   Distinct doc_ids</strong>
----------------------------------------------------------------------
  journals                         2        5,488                  0
  papers                           2        6,589              6,589
  extraction_units                42      208,940              6,578
  disease_mentions               454      227,000              5,622

<strong>CONSISTENCY CHECKS:</strong>
----------------------------------------------------------------------
  <strong>✓ OK</strong>: papers exists if disease_mentions exists
  <strong>✓ OK</strong>: papers exists if paper_disease_ranking exists
  <strong>✓ OK</strong>: extraction_units exists if disease_mentions exists

<strong>DOC_ID COVERAGE SUMMARY:</strong>
----------------------------------------------------------------------
  papers distinct doc_id:                 6,589
  extraction_units distinct doc_id:       6,578
  disease_mentions distinct doc_id: <strong>⚠️</strong>    <strong>5,622</strong>
  paper_disease_ranking distinct doc_id:      0

<strong>DOC_ID GAP COUNTS (papers minus …)</strong>:
----------------------------------------------------------------------
  papers \ paper_disease_ranking:      6,589
  papers \ disease_mentions: <strong>⚠️</strong>        - 967
  papers \ extraction_units: <strong>⚠️</strong>         - 11
                                  ----------
  <strong>Total Journals After Extraction</strong>      <strong>5,622</strong>

----------------------------------------------------------------------
<strong>AUDIT PASSED: No consistency issues found</strong>


======================================================================
<strong>2. ZONE COVERAGE REPORT</strong>
======================================================================
<strong>  Zone                          Created     No Words    Dispatched</strong>
----------------------------------------------------------------------
  abstract_lines                188,263            0       188,216
  metadata_abstract               6,236            1         6,234
  metadata_title                  6,544            2         6,541
  title_lines                     7,957            0         7,949
----------------------------------------------------------------------
======================================================================
<strong>SUCCESS: NER_01_TASK_DISPATCHER completed</strong>
  <strong>Papers dispatched:</strong> 6,589
  <strong>Papers failed:</strong> 47
 <strong> Papers failed cause:</strong> Misformed reading order
  <strong>Total units dispatched:</strong> 208,940
  <strong>Duration:</strong> 52.2 seconds
  <strong>Rate:</strong> 126.2 papers/second
  <strong>Rate:</strong> 4,002.7 units/second
======================================================================</code></pre>
~~~

~~~{=latex}
\begin{Verbatim}[commandchars=\\\{\}]
======================================================================
\textbf{1. PARQUET AUDIT REPORT (BERN2 ONLY)}
======================================================================

\textbf{TABLE STATISTICS:}
----------------------------------------------------------------------
\textbf{Table                  Parquet Files         Rows   Distinct doc_ids}
----------------------------------------------------------------------
  journals                         2        5,488                  0
  papers                           2        6,589              6,589
  extraction_units                42      208,940              6,578
  disease_mentions               454      227,000              5,622

\textbf{CONSISTENCY CHECKS:}
----------------------------------------------------------------------
  \textbf{✓ OK}: papers exists if disease_mentions exists
  \textbf{✓ OK}: papers exists if paper_disease_ranking exists
  \textbf{✓ OK}: extraction_units exists if disease_mentions exists

\textbf{DOC_ID COVERAGE SUMMARY:}
----------------------------------------------------------------------
  papers distinct doc_id:                 6,589
  extraction_units distinct doc_id:       6,578
  disease_mentions distinct doc_id: \textbf{⚠️}    \textbf{5,622}
  paper_disease_ranking distinct doc_id:      0

\textbf{DOC_ID GAP COUNTS (papers minus …)}:
----------------------------------------------------------------------
  papers \textbackslash\textbraceleft{\textbraceright{}\textbraceright{} paper_disease_ranking:      6,589
  papers \textbackslash\textbraceleft{\textbraceright{}\textbraceright{} disease_mentions: \textbf{⚠️}        - 967
  papers \textbackslash\textbraceleft{\textbraceright{}\textbraceright{} extraction_units: \textbf{⚠️}         - 11
                                  ----------
  \textbf{Total Journals After Extraction}      \textbf{5,622}

----------------------------------------------------------------------
\textbf{AUDIT PASSED: No consistency issues found}


======================================================================
\textbf{2. ZONE COVERAGE REPORT}
======================================================================
\textbf{  Zone                          Created     No Words    Dispatched}
----------------------------------------------------------------------
  abstract_lines                188,263            0       188,216
  metadata_abstract               6,236            1         6,234
  metadata_title                  6,544            2         6,541
  title_lines                     7,957            0         7,949
----------------------------------------------------------------------
======================================================================
\textbf{SUCCESS: NER_01_TASK_DISPATCHER completed}
  \textbf{Papers dispatched:} 6,589
  \textbf{Papers failed:} 47
 \textbf{ Papers failed cause:} Misformed reading order
  \textbf{Total units dispatched:} 208,940
  \textbf{Duration:} 52.2 seconds
  \textbf{Rate:} 126.2 papers/second
  \textbf{Rate:} 4,002.7 units/second
======================================================================
\end{Verbatim}
~~~








After Adding Mulitple Source Tagging:













~~~{=html}
<pre class="notion-ascii-diagram"><code>
{&quot;timestamp&quot;: &quot;2026-01-02 22:41:44,739&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;stage&quot;: &quot;NER_05_IMPORT_PARQUET&quot;, &quot;message&quot;: &quot;Running in AUDIT-ONLY mode (no import)&quot;}
{&quot;timestamp&quot;: &quot;2026-01-02 22:41:44,739&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;stage&quot;: &quot;NER_05_IMPORT_PARQUET&quot;, &quot;message&quot;: &quot;======================================================================&quot;}
{&quot;timestamp&quot;: &quot;2026-01-02 22:41:44,739&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;stage&quot;: &quot;NER_05_IMPORT_PARQUET&quot;, &quot;message&quot;: &quot;PARQUET AUDIT REPORT&quot;}
{&quot;timestamp&quot;: &quot;2026-01-02 22:41:44,739&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;stage&quot;: &quot;NER_05_IMPORT_PARQUET&quot;, &quot;message&quot;: &quot;======================================================================&quot;}
{&quot;timestamp&quot;: &quot;2026-01-02 22:41:44,739&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;stage&quot;: &quot;NER_05_IMPORT_PARQUET&quot;, &quot;message&quot;: &quot;Parquet directory: /app/output/parquet&quot;}
{&quot;timestamp&quot;: &quot;2026-01-02 22:41:44,739&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;stage&quot;: &quot;NER_05_IMPORT_PARQUET&quot;, &quot;message&quot;: &quot;&quot;}
{&quot;timestamp&quot;: &quot;2026-01-02 22:41:45,218&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;stage&quot;: &quot;NER_05_IMPORT_PARQUET&quot;, &quot;message&quot;: &quot;TABLE STATISTICS:&quot;}
{&quot;timestamp&quot;: &quot;2026-01-02 22:41:45,218&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;stage&quot;: &quot;NER_05_IMPORT_PARQUET&quot;, &quot;message&quot;: &quot;----------------------------------------------------------------------&quot;}
{&quot;timestamp&quot;: &quot;2026-01-02 22:41:45,218&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;stage&quot;: &quot;NER_05_IMPORT_PARQUET&quot;, &quot;message&quot;: &quot;Table                        Files         Rows   Distinct doc_ids&quot;}
{&quot;timestamp&quot;: &quot;2026-01-02 22:41:45,218&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;stage&quot;: &quot;NER_05_IMPORT_PARQUET&quot;, &quot;message&quot;: &quot;----------------------------------------------------------------------&quot;}
{&quot;timestamp&quot;: &quot;2026-01-02 22:41:45,218&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;stage&quot;: &quot;NER_05_IMPORT_PARQUET&quot;, &quot;message&quot;: &quot;journals                         2        5,488                  0&quot;}
{&quot;timestamp&quot;: &quot;2026-01-02 22:41:45,218&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;stage&quot;: &quot;NER_05_IMPORT_PARQUET&quot;, &quot;message&quot;: &quot;papers                           2        6,589              6,589&quot;}
{&quot;timestamp&quot;: &quot;2026-01-02 22:41:45,218&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;stage&quot;: &quot;NER_05_IMPORT_PARQUET&quot;, &quot;message&quot;: &quot;extraction_units                54      268,868              6,582&quot;}
{&quot;timestamp&quot;: &quot;2026-01-02 22:41:45,218&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;stage&quot;: &quot;NER_05_IMPORT_PARQUET&quot;, &quot;message&quot;: &quot;table_cells                      0            0                  0&quot;}
{&quot;timestamp&quot;: &quot;2026-01-02 22:41:45,218&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;stage&quot;: &quot;NER_05_IMPORT_PARQUET&quot;, &quot;message&quot;: &quot;disease_mentions              2545    1,272,500              6,511&quot;}
{&quot;timestamp&quot;: &quot;2026-01-02 22:41:45,218&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;stage&quot;: &quot;NER_05_IMPORT_PARQUET&quot;, &quot;message&quot;: &quot;feature_mentions                 0            0                  0&quot;}
{&quot;timestamp&quot;: &quot;2026-01-02 22:41:45,218&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;stage&quot;: &quot;NER_05_IMPORT_PARQUET&quot;, &quot;message&quot;: &quot;paper_disease_ranking            0            0                  0&quot;}
{&quot;timestamp&quot;: &quot;2026-01-02 22:41:45,218&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;stage&quot;: &quot;NER_05_IMPORT_PARQUET&quot;, &quot;message&quot;: &quot;&quot;}
{&quot;timestamp&quot;: &quot;2026-01-02 22:41:45,218&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;stage&quot;: &quot;NER_05_IMPORT_PARQUET&quot;, &quot;message&quot;: &quot;CONSISTENCY CHECKS:&quot;}
{&quot;timestamp&quot;: &quot;2026-01-02 22:41:45,218&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;stage&quot;: &quot;NER_05_IMPORT_PARQUET&quot;, &quot;message&quot;: &quot;----------------------------------------------------------------------&quot;}
{&quot;timestamp&quot;: &quot;2026-01-02 22:41:45,218&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;stage&quot;: &quot;NER_05_IMPORT_PARQUET&quot;, &quot;message&quot;: &quot;✓ OK: papers exists if disease_mentions exists&quot;}
{&quot;timestamp&quot;: &quot;2026-01-02 22:41:45,218&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;stage&quot;: &quot;NER_05_IMPORT_PARQUET&quot;, &quot;message&quot;: &quot;✓ OK: papers exists if paper_disease_ranking exists&quot;}
{&quot;timestamp&quot;: &quot;2026-01-02 22:41:45,218&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;stage&quot;: &quot;NER_05_IMPORT_PARQUET&quot;, &quot;message&quot;: &quot;✓ OK: extraction_units exists if disease_mentions exists&quot;}
{&quot;timestamp&quot;: &quot;2026-01-02 22:41:45,218&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;stage&quot;: &quot;NER_05_IMPORT_PARQUET&quot;, &quot;message&quot;: &quot;&quot;}
{&quot;timestamp&quot;: &quot;2026-01-02 22:41:45,218&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;stage&quot;: &quot;NER_05_IMPORT_PARQUET&quot;, &quot;message&quot;: &quot;DOC_ID COVERAGE SUMMARY:&quot;}
{&quot;timestamp&quot;: &quot;2026-01-02 22:41:45,218&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;stage&quot;: &quot;NER_05_IMPORT_PARQUET&quot;, &quot;message&quot;: &quot;----------------------------------------------------------------------&quot;}
{&quot;timestamp&quot;: &quot;2026-01-02 22:41:45,218&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;stage&quot;: &quot;NER_05_IMPORT_PARQUET&quot;, &quot;message&quot;: &quot;papers distinct doc_id:               6,589&quot;}
{&quot;timestamp&quot;: &quot;2026-01-02 22:41:45,218&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;stage&quot;: &quot;NER_05_IMPORT_PARQUET&quot;, &quot;message&quot;: &quot;extraction_units distinct doc_id:     6,582&quot;}
{&quot;timestamp&quot;: &quot;2026-01-02 22:41:45,218&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;stage&quot;: &quot;NER_05_IMPORT_PARQUET&quot;, &quot;message&quot;: &quot;disease_mentions distinct doc_id:     6,511&quot;}
{&quot;timestamp&quot;: &quot;2026-01-02 22:41:45,218&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;stage&quot;: &quot;NER_05_IMPORT_PARQUET&quot;, &quot;message&quot;: &quot;paper_disease_ranking distinct doc_id:0&quot;}
{&quot;timestamp&quot;: &quot;2026-01-02 22:41:45,396&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;stage&quot;: &quot;NER_05_IMPORT_PARQUET&quot;, &quot;message&quot;: &quot;&quot;}
{&quot;timestamp&quot;: &quot;2026-01-02 22:41:45,396&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;stage&quot;: &quot;NER_05_IMPORT_PARQUET&quot;, &quot;message&quot;: &quot;DOC_ID GAP COUNTS (papers minus …):&quot;}
{&quot;timestamp&quot;: &quot;2026-01-02 22:41:45,396&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;stage&quot;: &quot;NER_05_IMPORT_PARQUET&quot;, &quot;message&quot;: &quot;----------------------------------------------------------------------&quot;}
{&quot;timestamp&quot;: &quot;2026-01-02 22:41:45,396&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;stage&quot;: &quot;NER_05_IMPORT_PARQUET&quot;, &quot;message&quot;: &quot;papers \ extraction_units:           7&quot;}
{&quot;timestamp&quot;: &quot;2026-01-02 22:41:45,396&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;stage&quot;: &quot;NER_05_IMPORT_PARQUET&quot;, &quot;message&quot;: &quot;papers \ disease_mentions:           78&quot;}
{&quot;timestamp&quot;: &quot;2026-01-02 22:41:45,396&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;stage&quot;: &quot;NER_05_IMPORT_PARQUET&quot;, &quot;message&quot;: &quot;papers \ paper_disease_ranking:      6,589&quot;}
{&quot;timestamp&quot;: &quot;2026-01-02 22:41:45,397&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;stage&quot;: &quot;NER_05_IMPORT_PARQUET&quot;, &quot;message&quot;: &quot;Note: papers without disease_mentions / ranking are often NORMAL (no extracted diseases, or results-writer not finished yet).&quot;}
{&quot;timestamp&quot;: &quot;2026-01-02 22:41:45,397&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;stage&quot;: &quot;NER_05_IMPORT_PARQUET&quot;, &quot;message&quot;: &quot;&quot;}
{&quot;timestamp&quot;: &quot;2026-01-02 22:41:45,397&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;stage&quot;: &quot;NER_05_IMPORT_PARQUET&quot;, &quot;message&quot;: &quot;======================================================================&quot;}
{&quot;timestamp&quot;: &quot;2026-01-02 22:41:45,397&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;stage&quot;: &quot;NER_05_IMPORT_PARQUET&quot;, &quot;message&quot;: &quot;AUDIT PASSED: No consistency issues found&quot;}
{&quot;timestamp&quot;: &quot;2026-01-02 22:41:45,397&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;stage&quot;: &quot;NER_05_IMPORT_PARQUET&quot;, &quot;message&quot;: &quot;======================================================================&quot;}</code></pre>
~~~

~~~{=latex}
\begin{Verbatim}[commandchars=\\\{\}]

\textbraceleft{\textbraceright{}"timestamp": "2026-01-02 22:41:44,739", "level": "INFO", "stage": "NER_05_IMPORT_PARQUET", "message": "Running in AUDIT-ONLY mode (no import)"\textbraceright{}
\textbraceleft{\textbraceright{}"timestamp": "2026-01-02 22:41:44,739", "level": "INFO", "stage": "NER_05_IMPORT_PARQUET", "message": "======================================================================"\textbraceright{}
\textbraceleft{\textbraceright{}"timestamp": "2026-01-02 22:41:44,739", "level": "INFO", "stage": "NER_05_IMPORT_PARQUET", "message": "PARQUET AUDIT REPORT"\textbraceright{}
\textbraceleft{\textbraceright{}"timestamp": "2026-01-02 22:41:44,739", "level": "INFO", "stage": "NER_05_IMPORT_PARQUET", "message": "======================================================================"\textbraceright{}
\textbraceleft{\textbraceright{}"timestamp": "2026-01-02 22:41:44,739", "level": "INFO", "stage": "NER_05_IMPORT_PARQUET", "message": "Parquet directory: /app/output/parquet"\textbraceright{}
\textbraceleft{\textbraceright{}"timestamp": "2026-01-02 22:41:44,739", "level": "INFO", "stage": "NER_05_IMPORT_PARQUET", "message": ""\textbraceright{}
\textbraceleft{\textbraceright{}"timestamp": "2026-01-02 22:41:45,218", "level": "INFO", "stage": "NER_05_IMPORT_PARQUET", "message": "TABLE STATISTICS:"\textbraceright{}
\textbraceleft{\textbraceright{}"timestamp": "2026-01-02 22:41:45,218", "level": "INFO", "stage": "NER_05_IMPORT_PARQUET", "message": "----------------------------------------------------------------------"\textbraceright{}
\textbraceleft{\textbraceright{}"timestamp": "2026-01-02 22:41:45,218", "level": "INFO", "stage": "NER_05_IMPORT_PARQUET", "message": "Table                        Files         Rows   Distinct doc_ids"\textbraceright{}
\textbraceleft{\textbraceright{}"timestamp": "2026-01-02 22:41:45,218", "level": "INFO", "stage": "NER_05_IMPORT_PARQUET", "message": "----------------------------------------------------------------------"\textbraceright{}
\textbraceleft{\textbraceright{}"timestamp": "2026-01-02 22:41:45,218", "level": "INFO", "stage": "NER_05_IMPORT_PARQUET", "message": "journals                         2        5,488                  0"\textbraceright{}
\textbraceleft{\textbraceright{}"timestamp": "2026-01-02 22:41:45,218", "level": "INFO", "stage": "NER_05_IMPORT_PARQUET", "message": "papers                           2        6,589              6,589"\textbraceright{}
\textbraceleft{\textbraceright{}"timestamp": "2026-01-02 22:41:45,218", "level": "INFO", "stage": "NER_05_IMPORT_PARQUET", "message": "extraction_units                54      268,868              6,582"\textbraceright{}
\textbraceleft{\textbraceright{}"timestamp": "2026-01-02 22:41:45,218", "level": "INFO", "stage": "NER_05_IMPORT_PARQUET", "message": "table_cells                      0            0                  0"\textbraceright{}
\textbraceleft{\textbraceright{}"timestamp": "2026-01-02 22:41:45,218", "level": "INFO", "stage": "NER_05_IMPORT_PARQUET", "message": "disease_mentions              2545    1,272,500              6,511"\textbraceright{}
\textbraceleft{\textbraceright{}"timestamp": "2026-01-02 22:41:45,218", "level": "INFO", "stage": "NER_05_IMPORT_PARQUET", "message": "feature_mentions                 0            0                  0"\textbraceright{}
\textbraceleft{\textbraceright{}"timestamp": "2026-01-02 22:41:45,218", "level": "INFO", "stage": "NER_05_IMPORT_PARQUET", "message": "paper_disease_ranking            0            0                  0"\textbraceright{}
\textbraceleft{\textbraceright{}"timestamp": "2026-01-02 22:41:45,218", "level": "INFO", "stage": "NER_05_IMPORT_PARQUET", "message": ""\textbraceright{}
\textbraceleft{\textbraceright{}"timestamp": "2026-01-02 22:41:45,218", "level": "INFO", "stage": "NER_05_IMPORT_PARQUET", "message": "CONSISTENCY CHECKS:"\textbraceright{}
\textbraceleft{\textbraceright{}"timestamp": "2026-01-02 22:41:45,218", "level": "INFO", "stage": "NER_05_IMPORT_PARQUET", "message": "----------------------------------------------------------------------"\textbraceright{}
\textbraceleft{\textbraceright{}"timestamp": "2026-01-02 22:41:45,218", "level": "INFO", "stage": "NER_05_IMPORT_PARQUET", "message": "✓ OK: papers exists if disease_mentions exists"\textbraceright{}
\textbraceleft{\textbraceright{}"timestamp": "2026-01-02 22:41:45,218", "level": "INFO", "stage": "NER_05_IMPORT_PARQUET", "message": "✓ OK: papers exists if paper_disease_ranking exists"\textbraceright{}
\textbraceleft{\textbraceright{}"timestamp": "2026-01-02 22:41:45,218", "level": "INFO", "stage": "NER_05_IMPORT_PARQUET", "message": "✓ OK: extraction_units exists if disease_mentions exists"\textbraceright{}
\textbraceleft{\textbraceright{}"timestamp": "2026-01-02 22:41:45,218", "level": "INFO", "stage": "NER_05_IMPORT_PARQUET", "message": ""\textbraceright{}
\textbraceleft{\textbraceright{}"timestamp": "2026-01-02 22:41:45,218", "level": "INFO", "stage": "NER_05_IMPORT_PARQUET", "message": "DOC_ID COVERAGE SUMMARY:"\textbraceright{}
\textbraceleft{\textbraceright{}"timestamp": "2026-01-02 22:41:45,218", "level": "INFO", "stage": "NER_05_IMPORT_PARQUET", "message": "----------------------------------------------------------------------"\textbraceright{}
\textbraceleft{\textbraceright{}"timestamp": "2026-01-02 22:41:45,218", "level": "INFO", "stage": "NER_05_IMPORT_PARQUET", "message": "papers distinct doc_id:               6,589"\textbraceright{}
\textbraceleft{\textbraceright{}"timestamp": "2026-01-02 22:41:45,218", "level": "INFO", "stage": "NER_05_IMPORT_PARQUET", "message": "extraction_units distinct doc_id:     6,582"\textbraceright{}
\textbraceleft{\textbraceright{}"timestamp": "2026-01-02 22:41:45,218", "level": "INFO", "stage": "NER_05_IMPORT_PARQUET", "message": "disease_mentions distinct doc_id:     6,511"\textbraceright{}
\textbraceleft{\textbraceright{}"timestamp": "2026-01-02 22:41:45,218", "level": "INFO", "stage": "NER_05_IMPORT_PARQUET", "message": "paper_disease_ranking distinct doc_id:0"\textbraceright{}
\textbraceleft{\textbraceright{}"timestamp": "2026-01-02 22:41:45,396", "level": "INFO", "stage": "NER_05_IMPORT_PARQUET", "message": ""\textbraceright{}
\textbraceleft{\textbraceright{}"timestamp": "2026-01-02 22:41:45,396", "level": "INFO", "stage": "NER_05_IMPORT_PARQUET", "message": "DOC_ID GAP COUNTS (papers minus …):"\textbraceright{}
\textbraceleft{\textbraceright{}"timestamp": "2026-01-02 22:41:45,396", "level": "INFO", "stage": "NER_05_IMPORT_PARQUET", "message": "----------------------------------------------------------------------"\textbraceright{}
\textbraceleft{\textbraceright{}"timestamp": "2026-01-02 22:41:45,396", "level": "INFO", "stage": "NER_05_IMPORT_PARQUET", "message": "papers \textbackslash\textbraceleft{\textbraceright{}\textbraceright{} extraction_units:           7"\textbraceright{}
\textbraceleft{\textbraceright{}"timestamp": "2026-01-02 22:41:45,396", "level": "INFO", "stage": "NER_05_IMPORT_PARQUET", "message": "papers \textbackslash\textbraceleft{\textbraceright{}\textbraceright{} disease_mentions:           78"\textbraceright{}
\textbraceleft{\textbraceright{}"timestamp": "2026-01-02 22:41:45,396", "level": "INFO", "stage": "NER_05_IMPORT_PARQUET", "message": "papers \textbackslash\textbraceleft{\textbraceright{}\textbraceright{} paper_disease_ranking:      6,589"\textbraceright{}
\textbraceleft{\textbraceright{}"timestamp": "2026-01-02 22:41:45,397", "level": "INFO", "stage": "NER_05_IMPORT_PARQUET", "message": "Note: papers without disease_mentions / ranking are often NORMAL (no extracted diseases, or results-writer not finished yet)."\textbraceright{}
\textbraceleft{\textbraceright{}"timestamp": "2026-01-02 22:41:45,397", "level": "INFO", "stage": "NER_05_IMPORT_PARQUET", "message": ""\textbraceright{}
\textbraceleft{\textbraceright{}"timestamp": "2026-01-02 22:41:45,397", "level": "INFO", "stage": "NER_05_IMPORT_PARQUET", "message": "======================================================================"\textbraceright{}
\textbraceleft{\textbraceright{}"timestamp": "2026-01-02 22:41:45,397", "level": "INFO", "stage": "NER_05_IMPORT_PARQUET", "message": "AUDIT PASSED: No consistency issues found"\textbraceright{}
\textbraceleft{\textbraceright{}"timestamp": "2026-01-02 22:41:45,397", "level": "INFO", "stage": "NER_05_IMPORT_PARQUET", "message": "======================================================================"\textbraceright{}
\end{Verbatim}
~~~














~~~{=html}
<pre class="notion-ascii-diagram"><code>								 ┌────────────────────┐
								 │   <strong>task-dispatcher</strong>  │
								 └────────────────────┘      
                           │
                           │
                           ▼
                 ┌────────────────────┐
                 │     <strong> RabbitMQ  </strong>    │
                 │   (:5672, :15672)  │
                 └────────────────────┘
                    │    │    │    │
        ┌───────────┘ ┌──┘    └──┐ └────────────┐   
        ▼             ▼          ▼              ▼
   ┌──────────┐  ┌────────┐  ┌────────┐  ┌──────────────┐
   │<strong>  BERN2   │  │ GLiNER │  │PubMed- │  │results-writer│</strong>
   │   (x3)   │  │  (x3)  │  │BERT(x3)│  │     (x1)     │
   └──────────┘  └────────┘  └────────┘  └──────────────┘
         │            │          │              │
         └────────────┴──────────┘              │
                      │                         │
                      ▼                         ▼
              ┌────────────────┐         ┌──────────────┐
              │  ner.results   │────────▶│   Parquet    │
              │    queue       │         │    Files     │
              └────────────────┘         └──────────────┘</code></pre>
~~~

~~~{=latex}
\begin{Verbatim}[commandchars=\\\{\}]
								 ┌────────────────────┐
								 │   \textbf{task-dispatcher}  │
								 └────────────────────┘      
                           │
                           │
                           ▼
                 ┌────────────────────┐
                 │     \textbf{ RabbitMQ  }    │
                 │   (:5672, :15672)  │
                 └────────────────────┘
                    │    │    │    │
        ┌───────────┘ ┌──┘    └──┐ └────────────┐   
        ▼             ▼          ▼              ▼
   ┌──────────┐  ┌────────┐  ┌────────┐  ┌──────────────┐
   │\textbf{  BERN2   │  │ GLiNER │  │PubMed- │  │results-writer│}
   │   (x3)   │  │  (x3)  │  │BERT(x3)│  │     (x1)     │
   └──────────┘  └────────┘  └────────┘  └──────────────┘
         │            │          │              │
         └────────────┴──────────┘              │
                      │                         │
                      ▼                         ▼
              ┌────────────────┐         ┌──────────────┐
              │  ner.results   │────────▶│   Parquet    │
              │    queue       │         │    Files     │
              └────────────────┘         └──────────────┘
\end{Verbatim}
~~~







